# v0.11.0 â€” CI/CD Deployment & E2E Testing (Docker)

Released: TBD

## Overview

This release introduces Docker-based automated deployment workflows and end-to-end runtime testing capabilities for SMPStats development. Using dynamic Docker containers allows **parallel test runs** without port conflicts, enabling faster CI/CD pipelines.

## New Features

### Docker-Based Test Infrastructure
- **Dynamic container creation** - Each test/deployment gets isolated container
- **Automatic port allocation** - No conflicts between parallel runs
- **Parallel execution support** - Multiple PRs can test simultaneously
- **Auto-cleanup** - Containers removed after 2 hours or test completion

### Dev Deployment Workflow
- **Automatic deployment** to Docker containers on pushes to `dev` and `feature/**` branches
- **Dynamic ports** - MC, RCON, and API ports allocated automatically
- **SSH/SCP-based upload** - JAR uploaded and mounted into container
- **Log capture** for quick debugging of deployment issues
- **Manual trigger** support via `workflow_dispatch`

### End-to-End Runtime Tests
- **Real Paper server testing** - Dynamic Docker containers with SMPStats loaded
- **RCON command validation** - Tests `/smpstats info`, `/stats`, and connectivity
- **HTTP API testing** - Validates authentication, status codes, and JSON responses
- **Configurable Minecraft versions** - Default 1.21.10, selectable via manual trigger
- **Parallel test runs** - Multiple PRs/branches can test at the same time

### Test Coverage

#### RCON Tests
- Server connectivity (`/list`)
- Plugin info command (`/smpstats info`)
- Stats command (`/stats`)

#### HTTP API Tests
- Authentication rejection (401 without API key)
- Stats endpoint (200 + JSON validation)
- Online players endpoint
- Moments endpoint
- Health endpoint
- Heatmap endpoint
- Invalid UUID handling (400/404)

## Configuration

### Required GitHub Secrets (for Dev Deployment & E2E Tests)

| Secret | Description |
|--------|-------------|
| `DEV_SERVER_HOST` | SSH hostname (e.g., `nurrobin.de`) |
| `DEV_SERVER_USER` | SSH username |
| `DEV_SERVER_SSH_PORT` | SSH port for your server |
| `DEV_SERVER_SSH_KEY` | Private SSH key (OpenSSH format) |

## New Files

- `.github/workflows/deploy-dev.yml` - Docker-based dev deployment workflow
- `.github/workflows/e2e-runtime-test.yml` - Docker-based E2E runtime test workflow
- `.github/test-fixtures/README.md` - Test fixtures documentation
- `docs/CI_CD_DEPLOYMENT.md` - Comprehensive CI/CD documentation

## Server Requirements

For Docker-based deployment to work, the target server needs:
- Docker installed and accessible by the SSH user
- SSH access with key-based authentication
- `mcrcon` installed for RCON commands
- Pre-built `smpstats-paper` Docker image (built via manage script)
- Port ranges available: 25600-25699, 25700-25799, 8800-8899

## Migration Notes

No breaking changes. These are additive CI/CD improvements that don't affect plugin functionality.
